# Document 7: Summarize & Create PR Comment

## Context

- **Playbook**: Fabric PR Review
- **Agent**: {{AGENT_NAME}}
- **Project**: {{AGENT_PATH}}
- **Date**: {{DATE}}
- **Working Folder**: {{AUTORUN_FOLDER}}

## Purpose

Compile all review findings into a comprehensive summary and create a ready-to-post PR comment.

## Prerequisites

- `{{AUTORUN_FOLDER}}/REVIEW_SCOPE.md` - PR scope and changed files
- `{{AUTORUN_FOLDER}}/GO_ISSUES.md` - Go code quality issues
- `{{AUTORUN_FOLDER}}/PATTERN_ISSUES.md` - Pattern validation findings
- `{{AUTORUN_FOLDER}}/PLUGIN_ISSUES.md` - Plugin architecture issues
- `{{AUTORUN_FOLDER}}/SECURITY_ISSUES.md` - Security findings
- `{{AUTORUN_FOLDER}}/TEST_RESULTS.md` - Test execution results
- `{{AUTORUN_FOLDER}}/CHANGELOG.md` - Generated changelog

## Tasks

### Task 1: Load All Review Documents

- [ ] **Read all findings**: Load and review each document:
  - `REVIEW_SCOPE.md`
  - `GO_ISSUES.md`
  - `PATTERN_ISSUES.md`
  - `PLUGIN_ISSUES.md`
  - `SECURITY_ISSUES.md`
  - `TEST_RESULTS.md`
  - `CHANGELOG.md`

### Task 2: Determine Overall Verdict

- [ ] **Assess merge readiness**:
  - **Approve**: No blocking issues, tests pass, ready to merge
  - **Request Changes**: Has critical/major issues that must be fixed
  - **Comment**: Has suggestions but not blocking

- [ ] **Count issues by severity**:
  - Critical issues (blockers)
  - Major issues (should fix)
  - Minor issues (nice to fix)
  - Suggestions (optional)

- [ ] **Check Fabric PR requirements**:
  - [ ] PR is focused (not 50+ files)
  - [ ] Tests pass
  - [ ] Changelog generated
  - [ ] No security vulnerabilities

### Task 3: Prioritize Feedback

- [ ] **Rank issues**: Order all findings by impact:
  1. Security critical issues
  2. Test failures
  3. Build failures
  4. Go code critical issues
  5. Plugin interface violations
  6. Pattern structure issues
  7. Major issues
  8. Minor issues and suggestions

### Task 4: Create Summary Document

- [ ] **Write REVIEW_SUMMARY.md**: Create `{{AUTORUN_FOLDER}}/REVIEW_SUMMARY.md`:

```markdown
# Fabric PR Review Summary

**Review Date**: {{DATE}}
**Reviewer**: {{AGENT_NAME}}
**Project**: Fabric (danielmiessler/fabric)

---

## Overall Verdict: [APPROVE / REQUEST CHANGES / COMMENT]

### Summary
[2-3 sentence overview of the PR and key findings]

---

## Issue Count

| Category | Critical | Major | Minor | Suggestions |
|----------|----------|-------|-------|-------------|
| Go Code | X | X | X | X |
| Patterns | X | X | X | X |
| Plugins | X | X | X | X |
| Security | X | X | X | X |
| **Total** | **X** | **X** | **X** | **X** |

---

## Test Results

- **Build**: [PASS/FAIL]
- **Tests**: X passed, X failed, X skipped
- **Coverage**: [Overall coverage if available]

---

## Changelog Status

- [ ] Changelog generated successfully
- [ ] Content is accurate and complete

---

## Blocking Issues (Must Fix)

[List critical issues that block merge]

### Issue 1: [Title]
- **Category**: [Security/Go/Plugin/Pattern]
- **Location**: `file.go:123`
- **Description**: [What's wrong]
- **Recommendation**: [How to fix]

---

## Should Fix

[Issues that should be addressed but don't strictly block]

---

## Nice to Have

[Minor improvements and suggestions]

---

## Positive Feedback

[Good practices observed, well-done areas]

---

## Fabric PR Checklist

- [ ] PR is focused (< 50 files or justified)
- [ ] All tests pass
- [ ] Changelog generated
- [ ] No hardcoded secrets
- [ ] No security vulnerabilities
- [ ] Go idioms followed
- [ ] Patterns follow conventions (if applicable)
- [ ] Plugins implement interfaces (if applicable)

---

## Next Steps

1. [First action item]
2. [Second action item]
3. [etc.]

---

*Review generated by Maestro Fabric PR Review Playbook*
```

### Task 5: Create PR Comment

- [ ] **Write PR_COMMENT.md**: Create `{{AUTORUN_FOLDER}}/PR_COMMENT.md` for posting to GitHub:

```markdown
## Fabric PR Review

**Verdict**: :white_check_mark: Approve / :x: Request Changes / :speech_balloon: Comment

### Summary
[1-2 sentence overview]

### Key Findings

| Category | Issues |
|----------|--------|
| :shield: Security | X critical, X major |
| :gear: Go Code | X critical, X major |
| :jigsaw: Plugins | X critical, X major |
| :page_facing_up: Patterns | X critical, X major |

### Tests
- Build: :white_check_mark: / :x:
- Tests: X/X passing

### Changelog
:white_check_mark: Generated successfully / :x: Generation failed

---

<details>
<summary>:stop_sign: Blocking Issues (Click to expand)</summary>

[List critical/major issues with file locations and recommendations]

</details>

<details>
<summary>:warning: Should Fix</summary>

[List items that should be addressed]

</details>

<details>
<summary>:bulb: Suggestions</summary>

[Optional improvements]

</details>

---

### Action Required

- [ ] [First action item]
- [ ] [Second action item]
- [ ] Address blocking issues before merge

---

<details>
<summary>:clipboard: Generated Changelog</summary>

[Paste changelog content here]

</details>

---

*Automated review by [Maestro Fabric PR Review Playbook](https://github.com/pedramamini/Maestro)*
```

### Task 6: Final Verification

- [ ] **Verify completeness**: Ensure:
  - All issues from individual reviews are captured
  - Verdict is clearly stated
  - Next steps are actionable
  - Tone is constructive and professional
  - Changelog is included

- [ ] **Check PR comment formatting**:
  - GitHub markdown renders correctly
  - Collapsible sections work
  - Emojis are appropriate
  - Length is reasonable

## Success Criteria

- All review documents read and synthesized
- Overall verdict determined
- Issues prioritized by severity
- REVIEW_SUMMARY.md created
- PR_COMMENT.md created and ready to post
- Changelog included in comment
- Next steps are clear and actionable

## Status

Mark complete when summary and PR comment documents are created.

---

## Playbook Complete

When all 7 documents are complete, the Fabric PR review is finished!

**Generated Files:**
- `REVIEW_SCOPE.md` - PR scope analysis
- `GO_ISSUES.md` - Go code quality findings
- `PATTERN_ISSUES.md` - Pattern validation results
- `PLUGIN_ISSUES.md` - Plugin architecture review
- `SECURITY_ISSUES.md` - Security analysis
- `TEST_RESULTS.md` - Test execution and coverage
- `CHANGELOG.md` - Auto-generated changelog
- `REVIEW_SUMMARY.md` - Consolidated summary
- `PR_COMMENT.md` - Ready-to-post GitHub comment

**Next Steps:**
1. Review `REVIEW_SUMMARY.md` for accuracy
2. Copy `PR_COMMENT.md` content to GitHub PR
3. Follow up on any questions from the PR author
4. Re-run playbook after changes if needed
